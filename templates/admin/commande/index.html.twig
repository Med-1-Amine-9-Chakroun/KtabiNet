{% extends 'adminbase.html.twig' %}

{% block title %}Liste de commandes
{% endblock %}

{% block body %}
	<div class="container mt-4">
		<h1>Liste de commandes</h1>
		<br><br>

		<div class="mb-3">
			<label for="searchInput" class="form-label">Rechercher par mot-clé</label>
			<input type="text" class="form-control" id="searchInput" v-model="searchTerm">
		</div>

		<table class="table table-hover">
			<thead>
				<tr>
					<th scope="col" class="col-1">IDCommande</th>
					<th scope="col" class="col-1">DateCommande</th>
					<th scope="col" class="col-1">IDClient</th>
					<th scope="col" class="col-1">NomClient</th>
					<th scope="col" class="col-1">PrénomClient</th>
					<th scope="col" class="col-1">NbreLivres</th>
					<th scope="col" class="col-1">PrixTotal</th>
					<th scope="col" class="col-1">Etat</th>
					<th scope="col" class="col-1">Actions</th>
				</tr>
			</thead>
			<tbody>
				{% if commandes is empty %}
					<tr>
						<td colspan="8">Aucun enregistrement trouvé</td>
					</tr>
				{% else %}
					{% for commande in commandes %}
						<tr>
							<td>{{ commande.id }}</td>
							<td>{{ commande.DateCommande ? commande.DateCommande|date('Y-m-d') : '' }}</td>
							<td>{{ commande.idClient.id }}</td>
							<td>{{ commande.idClient.NomClient }}</td>
							<td>{{ commande.idClient.PrenomClient }}</td>
							<td>{{ commande.NbreLivres }}</td>
							<td>{{ commande.prixTotal }}</td>
							<td>{{ commande.etat }}</td>
							<td>
								<div class="btn-group" role="group" aria-label="Actions">
									<a href="{{ path('app_commande_edit', {'id': commande.id}) }}" class="btn btn-primary">
										<i class="fas fa-pencil-alt"></i>
										<span class="sr-only">Modifier</span>
									</a>
									<a href="{{ path('app_commande_delete', {'id': commande.id}) }}" class="btn btn-danger">
										<i class="fa-solid fa-trash"></i>
										<span class="sr-only">Supprimer</span>
									</a>
								</div>
							</td>
						</tr>
					{% endfor %}
				{% endif %}
			</tbody>
		</table>
	</div>
	 <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
	 <script>
									  new Vue({
									    el: '#app',
									    data: {
									      commandes: {{ commandes | json_encode() }},
									      searchTerm: '',
									    },
									    computed: {
									      filteredCommandes() {
									        return this.commandes.filter(commande => {
									          const lowerSearchTerm = this.searchTerm.toLowerCase();
									          return (
									            commande.id.toString().toLowerCase().includes(lowerSearchTerm) ||
									            commande.idClient.NomClient.toLowerCase().includes(lowerSearchTerm) ||
									            commande.idClient.PrenomClient.toLowerCase().includes(lowerSearchTerm)
									          );
									        });
									      }
									    }
									  });
									</script>

{% endblock %}
